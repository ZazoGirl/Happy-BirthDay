<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday! ğŸˆ</title>
  <style>
    :root{
      --bg: #0f1020;
      --bg2: #1a1b36;
      --accent: #ff6ec7;
      --accent2: #7cf7ff;
      --gold: #ffd166;
      --white: #f8f9ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, "Heebo", Arial, sans-serif;
      background: radial-gradient(1200px 800px at 70% 10%, var(--bg2), var(--bg));
      color:var(--white);
      overflow:hidden;
    }

    .stars, .stars:after{
      content:""; position:fixed; inset:0; pointer-events:none;
      background-image: radial-gradient(2px 2px at 20px 30px, #ffffff55, transparent),
                        radial-gradient(2px 2px at 130px 80px, #ffffff40, transparent),
                        radial-gradient(1px 1px at 60px 140px, #ffffff30, transparent),
                        radial-gradient(2px 2px at 240px 200px, #ffffff40, transparent),
                        radial-gradient(1px 1px at 300px 260px, #ffffff30, transparent);
      animation: twinkle 6s linear infinite;
      mix-blend-mode:screen;
    }
    .stars:after{ filter: blur(1px); opacity:.5; }
    @keyframes twinkle{ 0%,100%{opacity:.8} 50%{opacity:.4} }

    .wrap{
      position:relative; height:100%; width:100%; display:grid; place-items:center; padding: clamp(16px, 3vw, 48px);
    }
    .card{
      position:relative; width:min(1000px, 92vw); border-radius:28px; padding: clamp(18px, 4vw, 36px);
      background: linear-gradient(180deg, #ffffff08, #ffffff03);
      box-shadow: 0 20px 60px rgba(0,0,0,.4), inset 0 0 0 1px #ffffff18;
      backdrop-filter: blur(8px);
      overflow:hidden;
    }

    .title{
      font-size: clamp(36px, 7vw, 84px);
      line-height:1.05; margin: 8px 0 6px; text-align:center; font-weight:900;
      background: linear-gradient(90deg, var(--accent), var(--gold), var(--accent2), var(--accent));
      background-size: 200% 100%; -webkit-background-clip:text; background-clip:text; color:transparent;
      animation: shine 8s linear infinite;
      letter-spacing:.02em;
    }
    @keyframes shine{ 0%{background-position:0% 50%} 100%{background-position:200% 50%} }

    .subtitle{
      text-align:center; font-size: clamp(18px, 2.8vw, 28px); opacity:.95; margin:0 0 4px; font-weight:700;
      text-shadow: 0 0 10px #ffd16655, 0 0 18px #ff6ec733;
    }

    .blessed{
      margin: 16px auto 0; max-width: 65ch; text-align:center; font-size: clamp(16px, 2.2vw, 22px);
      opacity:.92; line-height:1.6;
    }

    .photo{
      width:min(420px, 70vw); aspect-ratio: 4/5; margin: clamp(16px, 3vw, 28px) auto; border-radius:22px; overflow:hidden;
      position:relative; box-shadow: 0 12px 50px #0008, 0 0 0 1px #ffffff22 inset;
      background:#111;
    }
    .photo img{ width:100%; height:100%; object-fit:cover; display:block; }
    .glow{ position:absolute; inset:-4px; border-radius:24px; pointer-events:none;
      background: conic-gradient(from 0deg, var(--accent), var(--gold), var(--accent2), var(--accent));
      filter: blur(14px); opacity:.45; animation: spin 12s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    .balloons{ position:fixed; inset:0; overflow:hidden; pointer-events:none; }
    .balloon{ position:absolute; bottom:-160px; width: var(--w); height: calc(var(--w) * 1.35); border-radius: 50% 50% 48% 52% / 56% 52% 48% 44%;
      background: radial-gradient(circle at 30% 30%, #ffffffaa, transparent 35%), var(--c);
      box-shadow: inset -8px -16px 20px #0002, 0 10px 20px #0004; opacity:.85;
      animation: float var(--dur) linear var(--delay) infinite;
    }
    .balloon:after{ content:""; position:absolute; bottom:-36px; left:45%; width:2px; height:40px; background:#ffffff66; box-shadow: 0 0 0 1px #ffffff22; }
    @keyframes float{
      0%{ transform: translateY(0) translateX(0) rotate(0); }
      50%{ transform: translateY(-50vh) translateX(20px) rotate(2deg); }
      100%{ transform: translateY(-110vh) translateX(-10px) rotate(-2deg); }
    }

    .sparkle{ position:absolute; width:6px; height:6px; background:var(--gold); box-shadow:0 0 8px #ffd166aa; transform:rotate(45deg); opacity:.8; animation: pop 1.8s ease-out forwards; }
    @keyframes pop{ 0%{ transform:translate(var(--x), var(--y)) scale(.6) rotate(0); opacity:1 } 100%{ transform:translate(calc(var(--x) * 2), calc(var(--y) * 2)) scale(0) rotate(180deg); opacity:0 } }

    .controls{
      position:fixed; left:12px; bottom:12px; display:flex; gap:8px; flex-wrap:wrap; z-index:10;
    }
    .btn{
      background:#ffffff12; color:#fff; border:1px solid #ffffff22; padding:10px 14px; border-radius:12px; cursor:pointer;
      backdrop-filter: blur(6px); font-weight:600; transition:.2s ease; font-size:14px;
    }
    .btn:hover{ background:#ffffff20; transform: translateY(-1px); }

    @media (max-width:480px){ .photo{ aspect-ratio:1; } }
  </style>
</head>
<body>
  <div class="stars"></div>
  <div class="balloons" id="balloons"></div>

  <div class="wrap">
    <div class="card">
      <p class="subtitle" id="sub">××–×œ ×˜×•×‘ ×¢×“ 120!</p>
      <h1 class="title" id="title">HAPPY BIRTHDAY ğŸ‰</h1>

      <div class="photo" id="photo">
        <img id="photoImg" alt="×ª××•× ×ª ×™×•× ×”×•×œ×“×ª" src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='1000'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%23ff6ec7'/%3E%3Cstop offset='1' stop-color='%237cf7ff'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill='%2314162e' width='100%25' height='100%25'/%3E%3Ccircle cx='400' cy='500' r='280' fill='url(%23g)' opacity='0.18'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='64' font-family='Segoe UI, Roboto, Heebo, Arial' fill='%23ffffffCC'%3EHappy Birthday%3C/text%3E%3C/svg%3E"/>
        <div class="glow" aria-hidden="true"></div>
      </div>

      <p class="blessed" id="bless">×©×ª××™×“ ×ª×”×™×™ ××•×§×¤×ª ××”×‘×”, ×‘×¨×™××•×ª ×•×©××—×”, ×©×”×—×œ×•××•×ª ×©×œ×š ×™×§×‘×œ×• ×›× ×¤×™×™× â€“ ×•×”×œ×‘ ×™×¨×’×™×© ×‘×‘×™×ª. ×™×•× ×”×•×œ×“×ª ×§×¡×•×! âœ¨</p>
    </div>
  </div>

  <div class="controls">
    <button class="btn" id="btnConfetti">×§×•× ×¤×˜×™ ğŸŠ</button>
    <button class="btn" id="btnReplay">×¢×•×“ ×‘×œ×•× ×™× ğŸˆ</button>
  </div>
  
  <!-- Tap-to-unmute overlay for strict autoplay policies -->
  <div id="tapOverlay" style="position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.35); backdrop-filter:blur(3px); z-index:20; visibility:hidden; opacity:0; transition:.25s ease;">
    <div style="background:#ffffff12; border:1px solid #ffffff22; padding:14px 18px; border-radius:14px; font-weight:700;">
      ×”×§×™×©×™ ×›×“×™ ×œ×”×¤×¢×™×œ ××•×–×™×§×” ğŸµ
    </div>
  </div>

  <audio id="music" autoplay loop>
    <source src="https://docs.google.com/uc?export=download&id=1Gj1nVEwVYFnbPb_w2cHBN_0tulIhnR9p" type="audio/mp3">
  </audio>

  <script>
    const qp = new URLSearchParams(location.search);
    const name = qp.get('name');
    const phrase = qp.get('phrase');
    const blessing = qp.get('blessing');
    const image = qp.get('image');
    const titleEl = document.getElementById('title');
    const subEl = document.getElementById('sub');
    const blessEl = document.getElementById('bless');

    if(name){
      titleEl.textContent = `HAPPY BIRTHDAY ${name}! ğŸ‰`;
    }
    if(phrase){ subEl.textContent = phrase; }
    if(blessing){ blessEl.textContent = blessing; }
    if(image){ document.getElementById('photoImg').src = image; }

    const colors = [
      'radial-gradient(circle at 30% 30%, #ffffffaa, transparent 35%), linear-gradient(180deg,#ffaad9,#ff6ec7)',
      'radial-gradient(circle at 30% 30%, #ffffffaa, transparent 35%), linear-gradient(180deg,#a9f7ff,#33d6ff)',
      'radial-gradient(circle at 30% 30%, #ffffffaa, transparent 35%), linear-gradient(180deg,#ffe58a,#ffd166)',
      'radial-gradient(circle at 30% 30%, #ffffffaa, transparent 35%), linear-gradient(180deg,#b6ffa1,#70ff8a)'
    ];

    const balloonsRoot = document.getElementById('balloons');
    function addBalloons(count = 10){
      const W = window.innerWidth;
      for(let i=0;i<count;i++){
        const b = document.createElement('div');
        b.className = 'balloon';
        const size = Math.round(60 + Math.random()*80);
        const left = Math.random() * (W - size);
        const dur = (10 + Math.random()*12).toFixed(2) + 's';
        const delay = (-Math.random()*8).toFixed(2) + 's';
        b.style.setProperty('--w', size + 'px');
        b.style.left = left + 'px';
        b.style.setProperty('--dur', dur);
        b.style.setProperty('--delay', delay);
        b.style.setProperty('--c', colors[Math.floor(Math.random()*colors.length)]);
        balloonsRoot.appendChild(b);
      }
    }

    setInterval(()=>addBalloons(5), 2000);

    function confettiBurst(x = innerWidth/2, y = innerHeight/3){
      const n = 90;
      for(let i=0;i<n;i++){
        const s = document.createElement('div');
        s.className = 'sparkle';
        const ang = Math.random() * Math.PI * 2;
        const r = 40 + Math.random()*180;
        s.style.setProperty('--x', (x + Math.cos(ang)*r) + 'px');
        s.style.setProperty('--y', (y + Math.sin(ang)*r) + 'px');
        s.style.left = x + 'px';
        s.style.top = y + 'px';
        s.style.background = i%3===0 ? '#ff6ec7' : (i%3===1 ? '#7cf7ff' : '#ffd166');
        document.body.appendChild(s);
        setTimeout(()=>s.remove(), 1800);
      }
    }

    document.getElementById('btnConfetti').addEventListener('click', e => {
      confettiBurst(innerWidth*0.5, innerHeight*0.35);
    });
    document.getElementById('btnReplay').addEventListener('click', e => addBalloons(10));

    setTimeout(()=>confettiBurst(innerWidth*0.5, innerHeight*0.35), 700);

    document.addEventListener('click', (e)=>{
      confettiBurst(e.clientX, e.clientY);
    });
  // Keep balloons flowing forever
    setInterval(()=>addBalloons(6), 2500);
  </script>

  <script>
    // Overlay logic â€“ show prompt if sound is still muted after load
    (function(){
      const overlay = document.getElementById('tapOverlay');
      function show(){ overlay.style.visibility='visible'; overlay.style.opacity='1'; }
      function hide(){ overlay.style.opacity='0'; setTimeout(()=>overlay.style.visibility='hidden', 250); }

      // Try to unmute programmatically (may fail due to policy); otherwise show prompt
      const tryUnmute = ()=>{
        try{
          if(window.ytPlayer && ytPlayer.unMute && ytPlayer.isMuted){
            if(ytPlayer.isMuted()){
              show();
            }else{
              hide();
            }
          } else {
            // YT not ready yet â€“ try again soon
            setTimeout(tryUnmute, 600);
          }
        }catch(e){ show(); }
      };
      setTimeout(tryUnmute, 1000);

      // Clicking anywhere already un-mutes via existing listeners; also hide overlay on click
      window.addEventListener('pointerdown', hide, { once:false });
      window.addEventListener('keydown', hide, { once:false });
    })();
  </script>
</body>
</html>
